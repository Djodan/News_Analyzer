News Flow - Implementation Guide
=================================

ğŸ“ CODE ORGANIZATION & FILE STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEEP CODE BASIC AND MODULAR - Each file has a specific purpose:

ğŸ“„ Globals.py
   - All global variables and dictionaries
   - _Currencies_ = {}
   - _Affected_ = {}
   - _Symbols_ = {}
   - Configuration variables (timeToTrade, ModeSelect, etc.)

ğŸ“„ Functions.py
   - General utility functions
   - enqueue_command() - sends commands to MQL5
   - checkTime() - time validation
   - add_message() - logging
   - Any other general-purpose helper functions

ğŸ“„ AI.py
   - General AI orchestration functions
   - process_news_event() - main AI pipeline coordinator
   - Any shared AI logic used by both Perplexity and ChatGPT

ğŸ“„ AI_Perplexity.py
   - Perplexity-specific functions ONLY
   - query_perplexity() - base Perplexity query function
   - get_news_data() - fetch forecast/actual from MyFxBook
   - Any other Perplexity-specific logic

ğŸ“„ AI_ChatGPT.py
   - ChatGPT-specific functions ONLY
   - query_chatgpt() - base ChatGPT query function
   - validate_news_data() - validate Perplexity responses
   - generate_trading_signals() - generate BUY/SELL decisions
   - Any other ChatGPT-specific logic

ğŸ“„ News.py
   - News trading algorithm implementation ONLY
   - Main handler function called by server
   - Implements the 7-step flow below
   - Keep it clean - call functions from other modules
   - No AI code here - use AI.py, AI_Perplexity.py, AI_ChatGPT.py

ğŸ“„ News_Flow.txt (this file)
   - Implementation blueprint and documentation

ğŸ“„ News_Rules.txt
   - AI instructions for trading signal generation (ChatGPT)

ğŸ“„ News_Research.txt
   - AI instructions for data extraction (Perplexity)

ğŸ“„ calendar_statement.csv
   - News events data (read-only)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OVERVIEW:
News.py monitors calendar_statement.csv for scheduled news events, pre-fetches Forecast data
for upcoming events, then monitors for Actual values when events occur. All data stored in
Globals dictionaries. NO CSV editing - read-only mode.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP-BY-STEP EXECUTION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: INITIALIZATION - PRE-FETCH ALL FORECASTS
-------------------------------------------------
File: calendar_statement.csv (READ-ONLY)
Location: News_Analyzer/calendar_statement.csv

ON STARTUP:
1. Get current time
2. Read CSV file (columns: Date, Event, Impact, Currency)
3. Parse ALL events from CSV

4. FOR EACH event in CSV:
   â†’ event_time = parse Date column
   â†’ event_name = Event column
   â†’ event_currency = Currency column
   
   5. IF event_time > current_time:
      â†’ Event is upcoming, proceed to fetch forecast
   
   6. IF event_time <= current_time:
      â†’ Event already passed, SKIP to next event
   
   7. Query Perplexity for Forecast:
      â†’ Include: News_Research.txt instructions
      â†’ Include: Event name
      â†’ Include: Event date/time
      â†’ Request: "Forecast value ONLY (Actual not available yet)"
      
   8. Perplexity returns:
      "Forecast : [number]"
      OR
      "Forecast : N/A" (if unavailable)
   
   9. Validate with ChatGPT:
      â†’ Include: News_Research.txt format rules
      â†’ Include: raw_response from Perplexity
      â†’ Ensure format correct
   
   10. CODE PARSES validated response:
       â†’ Extract forecast_value (float)
       â†’ Uses regex: r"Forecast\s*:\s*([\d\.\-]+|N/A)"
   
   11. Store in Globals._Currencies_:
       â†’ Globals._Currencies_[event_currency] = {
           "date": event_time,
           "event": event_name,
           "forecast": forecast_value,
           "actual": None,  # Not released yet
           "affect": None,  # Will be calculated when actual arrives
           "retry_count": 0  # Track Actual fetch attempts
         }
   
   11. LOG: "Pre-fetched forecast for [event_name]: [forecast_value]"

12. Sort all events by time (chronological order)
13. LOG: "Initialization complete - [X] events loaded with forecasts"
14. Proceed to STEP 2

Result: All upcoming events have Forecast pre-loaded in _Currencies_

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 2: TIME MONITORING LOOP - WAIT FOR EVENT RELEASE
------------------------------------------------------
WHILE True:
  1. Get current time
  2. Find NEXT upcoming event where:
     - Event Date/Time <= Current Time (event has occurred)
     - actual field in _Currencies_ is None (not processed yet)
  
  3. IF no events found:
     â†’ PRINT "EVENT SEQUENCE DONE"
     â†’ EXIT loop
  
  4. IF event found but current_time < event_time:
     â†’ WAIT (sleep/poll) until event_time reached
  
  5. WHEN event_time reached:
     â†’ Store event details:
       - event_time
       - event_name
       - event_currency
     â†’ Proceed to STEP 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 3: FETCH ACTUAL VALUE (AI #1 - Perplexity) WITH RETRY
-----------------------------------------------------------
WHEN event time reached:

1. Get existing forecast from Globals._Currencies_[event_currency]
   â†’ forecast_value = _Currencies_[event_currency]["forecast"]
   â†’ retry_count = _Currencies_[event_currency]["retry_count"]

2. Prepare query for Perplexity AI:
   â†’ Include: News_Research.txt instructions
   â†’ Include: Event name
   â†’ Include: Event date/time
   â†’ Request: "Actual value ONLY (Forecast already loaded)"

3. SEND to Perplexity AI

4. RECEIVE raw response from Perplexity

5. CHECK response:
   
   IF Perplexity returns "FALSE" (cannot find Actual value yet):
     â†’ INCREMENT retry_count
     â†’ UPDATE _Currencies_[event_currency]["retry_count"] = retry_count
     
     IF retry_count < 3:
       â†’ LOG: "Actual not available yet for [event_name], retry [retry_count]/3"
       â†’ WAIT 2 minutes
       â†’ RETURN to step 2 (retry this same event)
     
     ELSE (retry_count >= 3):
       â†’ LOG: "Failed to fetch Actual for [event_name] after 3 attempts - SKIPPING"
       â†’ UPDATE _Currencies_[event_currency]["actual"] = "FAILED"
       â†’ UPDATE _Currencies_[event_currency]["affect"] = "SKIPPED"
       â†’ SKIP this event, proceed to STEP 2 (next event)
   
   IF Perplexity returns valid data:
     â†’ Store raw_response
     â†’ Proceed to STEP 4

Expected format from Perplexity when successful:
"Actual : [number]"

6. Continue to STEP 4

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 4: VALIDATE FORMAT (AI #2 - ChatGPT)
------------------------------------------
PURPOSE: Ensure data format is exactly correct for parsing

1. Prepare validation query for ChatGPT:
   â†’ Include: News_Research.txt format rules
   â†’ Include: raw_response from Perplexity
   â†’ Request: Validate and correct format if needed

2. SEND to ChatGPT with instruction:
   "Validate this format and correct if needed. Output ONLY in format:
    Actual : [number]"

3. RECEIVE validated_response from ChatGPT

4. CODE PARSES validated_response:
   â†’ Extract actual_value (float)
   â†’ Uses regex: r"Actual\s*:\s*([\d\.\-]+)"

5. IF parsing fails:
   â†’ LOG error
   â†’ SKIP this event
   â†’ Return to STEP 2

6. IF parsing succeeds:
   â†’ Store: actual_value
   â†’ Proceed to STEP 4A

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 4A: STORE CURRENCY NEWS DATA
----------------------------------
PURPOSE: Save news results in Globals._Currencies_

1. CODE DETERMINES currency affect:
   IF actual_value > forecast_value:
     â†’ affect = "BULL"  # Currency strengthens
   ELIF actual_value < forecast_value:
     â†’ affect = "BEAR"  # Currency weakens
   ELSE:
     â†’ affect = "NEUTRAL"  # No change

2. CODE UPDATES Globals._Currencies_:
   â†’ Globals._Currencies_[event_currency]["actual"] = actual_value
   â†’ Globals._Currencies_[event_currency]["affect"] = affect

Final state example:
Globals._Currencies_["USD"] = {
  "date": "2025, November 11, 08:15",
  "event": "(United States) ADP Employment Change Weekly",
  "forecast": 43.7,
  "actual": 43.5,
  "affect": "BEAR",
  "retry_count": 0
}

3. Proceed to STEP 5

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 5: DETERMINE TRADING DIRECTIONS (AI #3 - ChatGPT)
-------------------------------------------------------
PURPOSE: Get BUY/SELL signals for all affected pairs

1. Prepare analysis query for ChatGPT:
   â†’ Include: News_Rules.txt (complete file)
   â†’ Include: Event currency (e.g., "USD", "GBP", "EUR")
   â†’ Include: forecast_value
   â†’ Include: actual_value
   â†’ Request: Trading directions for ALL pairs containing this currency

2. SEND to ChatGPT with instruction:
   "Using News_Rules.txt logic, provide trading signals.
    Currency: [event_currency]
    Forecast: [forecast_value]
    Actual: [actual_value]
    
    Output ONLY in format:
    PAIR1 : ACTION, PAIR2 : ACTION, PAIR3 : ACTION"

3. RECEIVE response from ChatGPT

Expected format:
"XAUUSD : BUY, EURUSD : BUY, USDJPY : SELL"

4. CODE PARSES response:
   â†’ Split by ", " to get individual pairs
   â†’ For each pair:
     - Extract pair_name (e.g., "XAUUSD")
     - Extract action (e.g., "BUY" or "SELL")
   â†’ Uses regex or string split
   â†’ Store in dictionary: {pair_name: action}

Example parsed result:
{
  "XAUUSD": "BUY",
  "EURUSD": "BUY", 
  "USDJPY": "SELL"
}

5. Proceed to STEP 6

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 6: UPDATE GLOBALS WITH TRADING SIGNALS
--------------------------------------------
1. Access Globals._Symbols_ dictionary
2. Access Globals._Affected_ dictionary

3. FOR EACH pair in parsed trading signals:
   â†’ pair_name = "XAUUSD"
   â†’ action = "BUY"
   
   4. CODE STORES in _Affected_ dictionary:
      â†’ Globals._Affected_[pair_name] = {
          "date": event_date_time,
          "event": event_name,
          "position": action
        }
   
   Example:
   Globals._Affected_["XAUUSD"] = {
     "date": "2025, November 11, 08:15",
     "event": "(United States) ADP Employment Change Weekly",
     "position": "BUY"
   }
   
   5. IF pair_name exists in Globals._Symbols_:
      â†’ CODE UPDATES Globals._Symbols_[pair_name]["verdict_GPT"] = action
   
   6. IF pair_name NOT in Globals._Symbols_:
      â†’ LOG warning: "Pair [pair_name] not found in _Symbols_"
      â†’ SKIP this pair (but still stored in _Affected_)

Result after processing USD negative news:
Globals._Affected_ = {
  "XAUUSD": {"date": "2025, November 11, 08:15", "event": "...", "position": "BUY"},
  "EURUSD": {"date": "2025, November 11, 08:15", "event": "...", "position": "BUY"},
  "USDJPY": {"date": "2025, November 11, 08:15", "event": "...", "position": "SELL"}
}

Globals._Symbols_["XAUUSD"]["verdict_GPT"] = "BUY"
Globals._Symbols_["EURUSD"]["verdict_GPT"] = "BUY"
Globals._Symbols_["USDJPY"]["verdict_GPT"] = "SELL"

7. Proceed to STEP 7

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 7: EXECUTE TRADES
-----------------------
1. FOR EACH pair with updated verdict_GPT:
   
   2. Get pair configuration:
      â†’ symbol = Globals._Symbols_[pair_name]["symbol"]
      â†’ lot = Globals._Symbols_[pair_name]["lot"]
      â†’ TP = Globals._Symbols_[pair_name]["TP"]
      â†’ SL = Globals._Symbols_[pair_name]["SL"]
      â†’ verdict = Globals._Symbols_[pair_name]["verdict_GPT"]
   
   3. Determine state based on verdict:
      IF verdict == "BUY":
        â†’ state = 1  # OPEN_BUY
      ELIF verdict == "SELL":
        â†’ state = 2  # OPEN_SELL
      ELSE:
        â†’ SKIP this pair
   
   4. Enqueue trade command:
      â†’ CALL enqueue_command(
          client_id,
          state,
          {
            "symbol": symbol,
            "volume": lot,
            "comment": f"NEWS {pair_name}",
            "tpPips": TP,
            "slPips": SL
          }
        )
   
   5. LOG: "Queued [verdict] for [pair_name]"

6. After all trades queued:
   â†’ RETURN to STEP 2 (check for next event)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ERROR HANDLING & EDGE CASES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CASE 1: Current time already passed an event (during STEP 1 pre-fetch)
â†’ SKIP event during initialization
â†’ Only pre-fetch forecasts for upcoming events

CASE 2: Actual value not available yet
â†’ Perplexity returns "FALSE"
â†’ Retry up to 3 times with 2-minute intervals
â†’ After 3 failures, mark event as "FAILED" and skip

CASE 3: AI response format invalid
â†’ LOG error with event details
â†’ SKIP this event
â†’ Continue to next event

CASE 4: No pairs match the news currency
â†’ LOG warning
â†’ Store in _Currencies_ but not in _Affected_
â†’ Continue to next event

CASE 5: Multiple events at same time
â†’ Process sequentially in CSV order
â†’ Execute all trades before moving to next event

CASE 6: CSV file corrupted or missing
â†’ LOG critical error
â†’ EXIT program with error message

CASE 7: Forecast fetch fails during initialization
â†’ LOG warning for specific event
â†’ Continue with other events
â†’ Skip this event during trading

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DATA FLOW SUMMARY (REFERENCE)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[STARTUP - STEP 1]
[Read CSV Events]
    â†“
[Filter: event_time > current_time]
    â†“
FOR EACH upcoming event:
    [Perplexity AI] â†’ Gets Forecast from news sources
        â†“ (raw response: "Forecast : X")
    [ChatGPT Validator] â†’ Ensures format correct
        â†“ (validated response)
    [CODE: Parse Values] â†’ Extract forecast_value using regex
        â†“
    [CODE: Store in _Currencies_] â†’ Save with actual=None, retry_count=0

[RUNTIME - STEP 2-7]
[Time Check Loop] â†’ Wait until event_time
    â†“
[Perplexity AI] â†’ Gets Actual value from news sources
    â†“ (raw response: "Actual : Y" OR "FALSE")
[Check if "FALSE"] â†’ If yes, retry up to 3 times (2 min intervals)
    â†“ (valid response: "Actual : Y")
[ChatGPT Validator] â†’ Ensures format correct
    â†“ (validated response)
[CODE: Parse Values] â†’ Extract actual_value using regex
    â†“
[CODE: Determine Affect] â†’ Compare Actual vs Forecast â†’ BULL/BEAR/NEUTRAL
    â†“
[CODE: Update _Currencies_] â†’ Save actual and affect
    â†“
[ChatGPT Analyzer] â†’ Apply News_Rules.txt logic
    â†“ (trading signals: "PAIR : ACTION, PAIR : ACTION...")
[CODE: Parse Signals] â†’ Extract {pair: action} dictionary
    â†“
[CODE: Store in _Affected_] â†’ Save pair-specific trading decisions
    â†“
[CODE: Update _Symbols_] â†’ Set verdict_GPT for each pair
    â†“
[Execute Trades] â†’ Enqueue commands for MT5
    â†“
[Next Event] â†’ Repeat from Time Check Loop

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GLOBAL STORAGE SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

THREE DICTIONARIES track news data:

1. Globals._Currencies_ â†’ Tracks news results per currency
   Format: currency â†’ {date, event, forecast, actual, affect, retry_count}
   
   Example during initialization (forecast only):
   "USD": {
     "date": "2025, November 11, 08:15",
     "event": "(United States) ADP Employment Change Weekly",
     "forecast": 43.7,
     "actual": None,
     "affect": None,
     "retry_count": 0
   }
   
   Example after event occurs (actual received):
   "USD": {
     "date": "2025, November 11, 08:15",
     "event": "(United States) ADP Employment Change Weekly",
     "forecast": 43.7,
     "actual": 43.5,
     "affect": "BEAR",
     "retry_count": 0
   }
   
   Example after failed retries:
   "GBP": {
     "date": "2025, November 13, 02:00",
     "event": "(United Kingdom) GDP Growth Rate",
     "forecast": 0.3,
     "actual": "FAILED",
     "affect": "SKIPPED",
     "retry_count": 3
   }
   
   Purpose: Store overall currency strength/weakness from news

2. Globals._Affected_ â†’ Tracks trading decisions per pair
   Format: pair â†’ {date, event, position}
   Example:
   "XAUUSD": {
     "date": "2025, November 11, 08:15",
     "event": "(United States) ADP Employment Change Weekly",
     "position": "BUY"
   }
   
   Purpose: Store which pairs to trade and in which direction

3. Globals._Symbols_ â†’ Tracks pair configurations (existing)
   Updated field: verdict_GPT = "BUY" or "SELL"
   Example: _Symbols_["XAUUSD"]["verdict_GPT"] = "BUY"
   
   Purpose: Signal trading engine which direction to execute

RELATIONSHIP:
_Currencies_ stores the NEWS RESULT (what happened to the currency)
  - Populated at STARTUP with forecasts (actual=None)
  - Updated at EVENT TIME with actual values
  - retry_count tracks Actual fetch attempts
_Affected_ stores the TRADING DECISION (how to trade each affected pair)
  - Only populated when actual value is received
_Symbols_ stores the EXECUTION SIGNAL (what the trading engine will use)
  - Only updated when trades are ready to execute

KEY CHANGES FROM PREVIOUS FLOW:
âœ“ NO CSV editing - calendar_statement.csv is READ-ONLY
âœ“ Forecasts pre-fetched on startup for ALL upcoming events
âœ“ Only Actual values fetched at event time
âœ“ Retry mechanism with 3 attempts, 2-minute intervals
âœ“ retry_count field added to _Currencies_ dictionary
âœ“ All data parsing done by CODE, not AI
âœ“ AI only outputs formatted text, CODE extracts values

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AI INTEGRATION POINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AI #1 (Perplexity) - News Research
-----------------------------------
PHASE 1 (Initialization):
INPUT: Event name, date/time
CONTEXT: News_Research.txt (SCENARIO A)
OUTPUT: "Forecast : [number]"
PURPOSE: Fetch forecast values before events occur

PHASE 2 (Runtime):
INPUT: Event name, date/time
CONTEXT: News_Research.txt (SCENARIO B)
OUTPUT: "Actual : [number]" OR "FALSE" if not available
PURPOSE: Fetch actual values when events are released

AI #2 (ChatGPT) - Format Validation
------------------------------------
PHASE 1 (Initialization):
INPUT: Raw response from Perplexity (Forecast only)
CONTEXT: News_Research.txt format rules
OUTPUT: "Forecast : [number]" (validated)
PURPOSE: Ensure parseable format for Forecast

PHASE 2 (Runtime):
INPUT: Raw response from Perplexity (Actual only)
CONTEXT: News_Research.txt format rules
OUTPUT: "Actual : [number]" (validated)
PURPOSE: Ensure parseable format for Actual

AI #3 (ChatGPT) - Trading Analysis
-----------------------------------
INPUT: Currency, Forecast value, Actual value
CONTEXT: News_Rules.txt (complete)
OUTPUT: "PAIR1 : ACTION, PAIR2 : ACTION, ..."
PURPOSE: Generate trading signals using base/quote logic

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CONSISTENCY ENFORCEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TO ENSURE FORMAT CONSISTENCY:

1. News_Research.txt provides THREE SCENARIOS to Perplexity:
   â†’ SCENARIO A: "Forecast : [number]" (initialization phase)
   â†’ SCENARIO B: "Actual : [number]" OR "FALSE" (runtime phase)
   â†’ SCENARIO C: "Forecast : [number], Actual : [number]" (both available)
   â†’ Perplexity returns appropriate format based on request

2. ChatGPT validator uses News_Research.txt rules:
   â†’ Phase 1: Validates "Forecast : [number]" format
   â†’ Phase 2: Validates "Actual : [number]" format
   â†’ Corrects if needed (removes %, extra text, etc.)
   â†’ Returns validated format

3. CODE Parser for Forecast (STEP 1):
   â†’ Regex: r"Forecast\s*:\s*([\d\.\-]+|N/A)"
   â†’ Extracts single float value
   â†’ Fails gracefully if format wrong

4. CODE Parser for Actual (STEP 4):
   â†’ Regex: r"Actual\s*:\s*([\d\.\-]+)"
   â†’ Extracts single float value
   â†’ Fails gracefully if format wrong

5. CODE Parser for Trading Signals (STEP 5):
   â†’ Split by ", " to get pairs
   â†’ For each: split by " : "
   â†’ Extracts pair names and actions
   â†’ Fails gracefully if format wrong

THIS MULTI-LAYER VALIDATION ENSURES:
âœ“ Perplexity knows exact format to return (3 scenarios)
âœ“ ChatGPT validates and corrects Perplexity output
âœ“ ChatGPT knows exact format for trading signals
âœ“ Code can reliably parse all outputs with simple regex
âœ“ Errors are caught before execution
âœ“ Two-phase approach (Forecast first, then Actual) is properly supported

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

